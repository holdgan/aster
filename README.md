
# Aster Trading System

åŸºäºLinuså“²å­¦çš„ç®€æ´åˆ†å¸ƒå¼åšå¸‚ç³»ç»Ÿï¼Œä¸“ä¸ºAsterDEX BTCUSDTäº¤æ˜“è®¾è®¡ã€‚

## ğŸ“ é¡¹ç›®ç»“æ„

```
aster/
â”œâ”€â”€ scripts/                           # æ ¸å¿ƒäº¤æ˜“è„šæœ¬
â”‚   â”œâ”€â”€ coordinator_cycle.py           # ğŸ¯ å¾ªç¯åº“å­˜ç­–ç•¥ (æ¨è)
â”‚   â”œâ”€â”€ coordinator_server.py          # ç›®æ ‡ä»“ä½ç­–ç•¥
â”‚   â”œâ”€â”€ executor_server.py             # æ‰§è¡Œå™¨æœåŠ¡ (B/CæœåŠ¡å™¨)
â”‚   â”œâ”€â”€ query_stats.py                 # äº¤æ˜“ç»Ÿè®¡æŸ¥è¯¢
â”‚   â”œâ”€â”€ start_coordinator.sh           # åè°ƒå™¨å¯åŠ¨è„šæœ¬
â”‚   â””â”€â”€ start_executor.sh              # æ‰§è¡Œå™¨å¯åŠ¨è„šæœ¬
â”œâ”€â”€ aster_btcusdt_genesis.py           # äº¤æ˜“å®¢æˆ·ç«¯æ ¸å¿ƒåº“
â”œâ”€â”€ .env.example                       # ç¯å¢ƒé…ç½®æ¨¡æ¿
â”œâ”€â”€ requirements.txt                   # Pythonä¾èµ–
â””â”€â”€ README.md                          # æœ¬æ–‡ä»¶
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. é…ç½®ç¯å¢ƒ
```bash
# å¤åˆ¶ç¯å¢ƒé…ç½®æ–‡ä»¶
cp .env.example .env

# ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼Œå¡«å…¥APIå¯†é’¥
vim .env
```

éœ€è¦é…ç½®çš„å˜é‡ï¼š
```bash
ASTER_A_KEY=your_coordinator_api_key
ASTER_A_SECRET=your_coordinator_api_secret
ASTER_B_KEY=your_executor_b_api_key
ASTER_B_SECRET=your_executor_b_api_secret
ASTER_C_KEY=your_executor_c_api_key
ASTER_C_SECRET=your_executor_c_api_secret

# æœåŠ¡å™¨åœ°å€ï¼ˆå¯é€‰ï¼Œé»˜è®¤localhostï¼‰
SERVER_B_URL=http://server-b-ip:8081
SERVER_C_URL=http://server-c-ip:8082
```

### 2. å®‰è£…ä¾èµ–
```bash
pip3 install -r requirements.txt
```

### 3. å¯åŠ¨ç³»ç»Ÿ

**æ­¥éª¤1: åœ¨æœåŠ¡å™¨Bä¸Šå¯åŠ¨æ‰§è¡Œå™¨**
```bash
cd scripts
./start_executor.sh --account B --port 8081
```

**æ­¥éª¤2: åœ¨æœåŠ¡å™¨Cä¸Šå¯åŠ¨æ‰§è¡Œå™¨**
```bash
cd scripts
./start_executor.sh --account C --port 8082
```

**æ­¥éª¤3: åœ¨æœåŠ¡å™¨Aä¸Šå¯åŠ¨åè°ƒå™¨ï¼ˆå¾ªç¯åº“å­˜ç­–ç•¥ï¼‰**
```bash
cd scripts
./start_coordinator.sh --strategy cycle
```

### 4. æŸ¥çœ‹äº¤æ˜“ç»Ÿè®¡
```bash
# æŸ¥è¯¢æœ€è¿‘2å°æ—¶çš„äº¤æ˜“ç»Ÿè®¡
python3 scripts/query_stats.py

# æŸ¥è¯¢æœ€è¿‘6å°æ—¶
python3 scripts/query_stats.py --hours 6

# æŸ¥è¯¢ç‰¹å®šæœåŠ¡å™¨
python3 scripts/query_stats.py --servers B
```

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Server A (åè°ƒå™¨)   â”‚
â”‚  - è·å–è¡Œæƒ…æ•°æ®      â”‚
â”‚  - è®¡ç®—ä»“ä½ç­–ç•¥      â”‚
â”‚  - å‘é€äº¤æ˜“ä¿¡å·      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
     â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
     â”‚           â”‚
â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”
â”‚Server B â”‚ â”‚Server C â”‚
â”‚æ‰§è¡Œå™¨   â”‚ â”‚æ‰§è¡Œå™¨   â”‚
â”‚- Maker  â”‚ â”‚- Maker  â”‚
â”‚- Taker  â”‚ â”‚- Taker  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å¾ªç¯åº“å­˜ç­–ç•¥ (coordinator_cycle.py)

**æ ¸å¿ƒé€»è¾‘ï¼š**
1. **ç›¸ä½å¾ªç¯**: Bå’ŒCäº¤æ›¿è¾¾åˆ°æœ€å¤§å¤šå¤´/ç©ºå¤´ä»“ä½
   - Phase 1: Bâ†’æœ€å¤§å¤šå¤´, Câ†’æœ€å¤§ç©ºå¤´
   - Phase 2: Bâ†’æœ€å¤§ç©ºå¤´, Câ†’æœ€å¤§å¤šå¤´
   - å¾ªç¯å¾€å¤ï¼Œæœ€å¤§åŒ–äº¤æ˜“é‡

2. **è®¢å•ç±»å‹**:
   - **Makerè®¢å•**: æŒ‚é™ä»·å•æä¾›æµåŠ¨æ€§ï¼ˆè´¹ç‡0.01%ï¼‰
   - **Takerè®¢å•**: ç´§æ€¥å¹³è¡¡å‡€æ•å£ï¼ˆè´¹ç‡0.035%ï¼‰

3. **é£æ§æœºåˆ¶**:
   - å‡€æ•å£æ§åˆ¶: ä¸¤æœåŠ¡å™¨æ€»æ•å£ < 4%æ€»ä»“ä½
   - å•æœåŠ¡å™¨é™åˆ¶: 5000 USDä¿è¯é‡‘
   - è®¢å•è¿‡æœŸæ—¶é—´: 5-30ç§’è‡ªåŠ¨å–æ¶ˆ

## âš™ï¸ ç­–ç•¥å‚æ•°é…ç½®

æ‰€æœ‰ç­–ç•¥å‚æ•°é›†ä¸­åœ¨æ–‡ä»¶å¼€å¤´ï¼Œæ–¹ä¾¿è°ƒæ•´ï¼š

### coordinator_cycle.py å…³é”®å‚æ•°

**ä»“ä½é™åˆ¶** (ç¬¬45-46è¡Œ):
```python
MAX_POSITION_B_USD = 5000.0  # Server Bæœ€å¤§ä»“ä½
MAX_POSITION_C_USD = 5000.0  # Server Cæœ€å¤§ä»“ä½
```

**è®¢å•å‚æ•°** (ç¬¬64-78è¡Œ):
```python
maker_step_btc: float = 0.002          # å•ç¬”è®¢å•BTCæ•°é‡
decision_interval: float = 5.0         # å†³ç­–é¢‘ç‡ï¼ˆç§’ï¼‰
maker_expire_seconds: float = 30.0     # Makerè®¢å•è¿‡æœŸæ—¶é—´
signal_delay_max: float = 5.0          # éšæœºå»¶è¿Ÿä¸Šé™
maker_price_offset: float = 0.1        # æŒ‚å•ä»·æ ¼åç§»
```

**å»ºè®®è°ƒæ•´åœºæ™¯**ï¼š
- åŠ å¿«å»ºä»“é€Ÿåº¦ï¼šå¢å¤§ `maker_step_btc` (å¦‚0.005)
- æé«˜å“åº”é€Ÿåº¦ï¼šå‡å° `decision_interval` (å¦‚2.0)
- é™ä½æ»‘ç‚¹ï¼šå‡å° `maker_price_offset` (å¦‚0.05)

## ğŸ“Š ç›‘æ§å’Œç»Ÿè®¡

### æ‰§è¡Œå™¨å¥åº·æ£€æŸ¥
```bash
# æ£€æŸ¥BæœåŠ¡å™¨
curl http://server-b-ip:8081/health

# æ£€æŸ¥CæœåŠ¡å™¨
curl http://server-c-ip:8082/health
```

### æŸ¥çœ‹è¯¦ç»†çŠ¶æ€
```bash
curl http://server-b-ip:8081/status
```

### äº¤æ˜“ç»Ÿè®¡æŠ¥å‘Š
```bash
# å®Œæ•´ç»Ÿè®¡ï¼ˆåŒ…å«è´¹ç”¨å’ŒP&Lï¼‰
python3 scripts/query_stats.py

# è¾“å‡ºç¤ºä¾‹ï¼š
# Server B Statistics:
#   Taker: 15 orders, $12,450 volume
#   Maker: 143 orders, $47,380 volume (æˆåŠŸç‡ 95.3%)
#   Fees: $7.15
#   Realized P&L: -$13.70 (2.29 basis points)
```

### ç´§æ€¥åœæ­¢
```bash
curl -X POST http://server-b-ip:8081/emergency_stop
```

## ğŸ›¡ï¸ é£æ§è¯´æ˜

### å¤šå±‚é˜²æŠ¤æœºåˆ¶

1. **ä»“ä½é™åˆ¶**: å•æœåŠ¡å™¨æœ€å¤§5000 USD
2. **å‡€æ•å£æ§åˆ¶**: B+Cæ€»æ•å£ < 4% Ã— æ€»ä»“ä½
3. **è®¢å•è¿‡æœŸ**: 5-30ç§’è‡ªåŠ¨å–æ¶ˆæœªæˆäº¤è®¢å•
4. **ä»·æ ¼ä¿æŠ¤**: Makerè®¢å•åç¦»å¸‚ä»· Â±0.1 USD
5. **é¢‘ç‡é™åˆ¶**: 5ç§’å†³ç­–é—´éš”ï¼Œé¿å…è¿‡åº¦äº¤æ˜“

### å¼‚å¸¸æƒ…å†µå¤„ç†

- **ç½‘ç»œä¸­æ–­**: æ‰§è¡Œå™¨ç‹¬ç«‹è¿è¡Œï¼Œä¸ä¼šæ— åºäº¤æ˜“
- **APIå¤±è´¥**: è‡ªåŠ¨é‡è¯•ï¼Œ3æ¬¡å¤±è´¥åè·³è¿‡
- **ä»·æ ¼å‰§çƒˆæ³¢åŠ¨**: å‡€æ•å£è¶…é™æ—¶å¼ºåˆ¶Takerå¹³è¡¡

## ğŸ”§ å¸¸è§é—®é¢˜

### Q: å¦‚ä½•è°ƒæ•´ä»“ä½é™åˆ¶ï¼Ÿ
A: ä¿®æ”¹ `coordinator_cycle.py` ç¬¬45-46è¡Œçš„ `MAX_POSITION_B_USD` å’Œ `MAX_POSITION_C_USD`

### Q: å¦‚ä½•åŠ å¿«å»ºä»“é€Ÿåº¦ï¼Ÿ
A: å¢å¤§ `maker_step_btc` å‚æ•°ï¼ˆç¬¬64è¡Œï¼‰ï¼Œå¦‚ä»0.002æ”¹ä¸º0.005

### Q: è®¢å•æˆäº¤ç‡ä½æ€ä¹ˆåŠï¼Ÿ
A: å‡å° `maker_price_offset`ï¼ˆç¬¬78è¡Œï¼‰ï¼Œå¦‚ä»0.1æ”¹ä¸º0.05ï¼Œä½¿æŒ‚å•æ›´æ¥è¿‘å¸‚ä»·

### Q: å¦‚ä½•æŸ¥çœ‹å†å²P&Lï¼Ÿ
A: è¿è¡Œ `python3 scripts/query_stats.py --hours 24` æŸ¥çœ‹24å°æ—¶ç»Ÿè®¡

---

**Linuså“²å­¦**: "Talk is cheap. Show me the code." - æ‰€æœ‰å‚æ•°é›†ä¸­åœ¨æ–‡ä»¶å¼€å¤´ï¼Œç›´æ¥ä¿®æ”¹å³å¯ç”Ÿæ•ˆã€‚
