# Aster 交易系统 - 环境配置文件
# 复制此文件为 .env 并填入你的配置值
#
# ===== 核心策略: 净敞口约等于0 =====
# 系统通过以下机制维持净敞口接近零:
# 1. 协调器A监控B、C两个账户的总净仓位
# 2. 当净敞口超过容忍度时，优先调整maker订单方向
# 3. 紧急情况下，协调器A执行taker订单快速平衡
# 4. 目标: |净敞口| < NET_EXPOSURE_TOLERANCE (默认50美元)
#
# 风险控制层级:
# Level 1: 容忍度内 (0-50美元) - 正常运行
# Level 2: 警告区间 (50-100美元) - 调整maker策略
# Level 3: 紧急区间 (100-200美元) - 减少新订单
# Level 4: 强制平衡 (>200美元) - 立即执行taker平衡单

# ===== 服务器A (协调器) =====
ASTER_A_KEY=your_api_key_here              # 协调器账户的API密钥
ASTER_A_SECRET=your_api_secret_here        # 协调器账户的API密码

# ===== 服务器B (通用执行器) =====
ASTER_B_KEY=your_api_key_here              # 执行器B账户的API密钥
ASTER_B_SECRET=your_api_secret_here        # 执行器B账户的API密码

# ===== 服务器C (通用执行器) =====
ASTER_C_KEY=your_api_key_here              # 执行器C账户的API密钥
ASTER_C_SECRET=your_api_secret_here        # 执行器C账户的API密码

# ===== 网络配置 =====
# 服务器B的访问地址 (从服务器A的角度)
SERVER_B_URL=http://server-b-ip:8081

# 服务器C的访问地址 (从服务器A的角度)
SERVER_C_URL=http://server-c-ip:8082

# 协调器服务器地址 (从服务器B/C的角度，暂未使用)
COORDINATOR_URL=http://server-a-ip:8080

# ===== 交易参数 (不对称保证金配置) =====
# 账户资金配置: A=5000U, B=1000U, C=1000U

# A账户配置 (5000U保证金 - 协调器主力)
MAX_POSITION_A_USD=3000.0                   # A账户最大仓位 (60%保证金利用率)
MAX_ORDER_A_USD=1000.0                      # A账户最大单笔订单
DAILY_LOSS_LIMIT_A=1000.0                   # A账户每日亏损限制

# B账户配置 (1000U保证金 - 执行器)
MAX_POSITION_B_USD=4000.0                   # B账户最大仓位 (提高以支持更多maker订单)
MAX_ORDER_B_USD=200.0                       # B账户最大单笔订单
DAILY_LOSS_LIMIT_B=200.0                    # B账户每日亏损限制

# C账户配置 (1000U保证金 - 执行器)
MAX_POSITION_C_USD=4000.0                   # C账户最大仓位 (提高以支持更多maker订单)
MAX_ORDER_C_USD=200.0                       # C账户最大单笔订单
DAILY_LOSS_LIMIT_C=200.0                    # C账户每日亏损限制

# 系统整体配置
TOTAL_CAPITAL_USD=7000.0                    # 总资金 (5000+1000+1000)
TARGET_VOLUME_PER_HOUR=8000.0               # 每小时目标交易量 (提升以匹配更大资金)

# 订单大小配置
COORDINATOR_ORDER_SIZE_USD=150.0            # 协调器每次发送的订单大小（美元）
COORDINATOR_MAX_ORDER_BTC=0.1               # 协调器每次订单的最大BTC数量

# ===== 净敞口控制 (基于不对称资金的策略) =====
# 系统总净敞口限制 (美元) - 基于总资金7000U调整
MAX_NET_EXPOSURE_USD=200.0                  # 提升至200U (约3%总资金)

# 净敞口平衡容忍度 (美元) - 超过此值将触发平衡操作
NET_EXPOSURE_TOLERANCE=100.0                # 提升至100U容忍度

# 净敞口检查间隔 (秒) - 系统检查净敞口的频率
NET_EXPOSURE_CHECK_INTERVAL=10.0

# 紧急平衡阈值 (美元) - 超过此净敞口将立即执行taker平衡单
EMERGENCY_BALANCE_THRESHOLD=300.0           # 提升至300U紧急阈值

# 平衡操作优先级: taker > maker (true=优先taker快速平衡, false=优先maker节省手续费)
BALANCE_PREFER_TAKER=true

# ===== 账户间平衡权重 =====
# A账户平衡权重 (A承担主要净敞口平衡责任)
ACCOUNT_A_BALANCE_WEIGHT=0.6                # 60%净敞口平衡由A承担
ACCOUNT_B_BALANCE_WEIGHT=0.2                # 20%净敞口平衡由B承担
ACCOUNT_C_BALANCE_WEIGHT=0.2                # 20%净敞口平衡由C承担

# 仓位分配策略
A_PREFERRED_POSITION_RATIO=0.5              # A倾向于承担50%总仓位
BC_COMPLEMENTARY_STRATEGY=true              # B/C执行互补策略

# ===== 风险管理 (基于不对称资金调整) =====
# 紧急停止条件 - 亏损百分比阈值
EMERGENCY_STOP_LOSS_PERCENT=5.0

# API失败容忍度 - 每分钟最大失败次数
MAX_API_FAILURES_PER_MINUTE=5

# 账户特定仓位集中度限制
MAX_POSITION_CONCENTRATION_A=0.6            # A账户最大60%仓位集中
MAX_POSITION_CONCENTRATION_B=0.8            # B账户可接受80%集中度 (小资金)
MAX_POSITION_CONCENTRATION_C=0.8            # C账户可接受80%集中度 (小资金)

# 账户间仓位差异控制
MAX_BC_POSITION_DIFF=400.0                  # B和C账户仓位差异最大400U
MAX_A_BC_RATIO=3.0                          # A账户仓位不超过B+C的3倍

# 保证金安全系数
MARGIN_SAFETY_FACTOR_A=0.4                 # A账户保留40%保证金安全边际
MARGIN_SAFETY_FACTOR_B=0.3                 # B账户保留30%保证金安全边际
MARGIN_SAFETY_FACTOR_C=0.3                 # C账户保留30%保证金安全边际

# 仓位再平衡触发间隔 (秒)
REBALANCE_CHECK_INTERVAL=30.0

# 动态风控参数
DRAWDOWN_ALERT_THRESHOLD_A=500.0            # A账户浮亏500U告警
DRAWDOWN_ALERT_THRESHOLD_B=100.0            # B账户浮亏100U告警
DRAWDOWN_ALERT_THRESHOLD_C=100.0            # C账户浮亏100U告警

# ===== 积分优化 (基于7000U总资金) =====
# 团队加成倍数 (1.5 = 50%加成)
TEAM_BOOST_MULTIPLIER=1.5

# 优先抵押资产 (逗号分隔，获得额外积分)
PREFERRED_COLLATERAL_ASSETS=USDF,ASBNB

# Maker订单奖励倍数 (1.2 = 20%额外积分)
MAKER_BONUS_MULTIPLIER=1.2

# 账户特定Maker目标比例
TARGET_MAKER_RATIO_A=0.7                    # A账户70% Maker (承担更多taker平衡单)
TARGET_MAKER_RATIO_B=0.85                   # B账户85% Maker (专注积分)
TARGET_MAKER_RATIO_C=0.85                   # C账户85% Maker (专注积分)

# 持仓积分优化
MIN_HOLDING_TIME=300                         # 最小持仓5分钟
OPTIMAL_POSITION_A=2000.0                    # A账户最优持仓积分仓位
OPTIMAL_POSITION_B=500.0                     # B账户最优持仓积分仓位
OPTIMAL_POSITION_C=500.0                     # C账户最优持仓积分仓位

# 积分策略权重
TRADING_POINTS_WEIGHT=0.4                    # 交易积分权重40%
HOLDING_POINTS_WEIGHT=0.4                    # 持仓积分权重40%
TEAM_POINTS_WEIGHT=0.2                       # 团队积分权重20%

# 净敞口积分优化模式
OPTIMIZE_FOR_POINTS=true                     # 优先积分最大化
POINTS_RISK_BALANCE=0.7                      # 70%偏向积分，30%偏向风控

# ===== 日志配置 =====
LOG_LEVEL=INFO                             # 日志级别: DEBUG, INFO, WARNING, ERROR
LOG_FILE_PATH=/var/log/aster/trading.log   # 日志文件路径

# ===== 监控配置 =====
# 健康检查间隔 (秒)
HEALTH_CHECK_INTERVAL=30

# 性能报告间隔 (秒)
PERFORMANCE_REPORT_INTERVAL=300

# 告警webhook地址 (可选，用于发送告警通知)
ALERT_WEBHOOK_URL=

# ===== 高级设置 (差异化配置避免检测) =====
# 服务器特定循环间隔 (避免同步)
LOOP_INTERVAL_A=2.0                         # A服务器循环间隔
LOOP_INTERVAL_B=2.1                         # B服务器循环间隔 (略有差异)
LOOP_INTERVAL_C=1.9                         # C服务器循环间隔 (略有差异)

# 信号超时时间 (秒)
SIGNAL_TIMEOUT=5.0

# 账户特定订单参数
ORDER_EXPIRY_TIME_A=30.0                    # A账户订单过期时间
ORDER_EXPIRY_TIME_B=28.0                    # B账户订单过期时间 (差异化)
ORDER_EXPIRY_TIME_C=32.0                    # C账户订单过期时间 (差异化)

# 价格偏离容忍度差异化
PRICE_DEVIATION_TOLERANCE_A=0.020           # A账户2.0%
PRICE_DEVIATION_TOLERANCE_B=0.021           # B账户2.1% (微调)
PRICE_DEVIATION_TOLERANCE_C=0.019           # C账户1.9% (微调)

# ===== 实际运行建议配置 =====
# 根据A:5000U, B:1000U, C:1000U的实际情况

# 推荐起始仓位分配 (净敞口≈0)
RECOMMENDED_START_POSITION_A=1500.0         # A账户建议起始多头1500U
RECOMMENDED_START_POSITION_B=-750.0         # B账户建议起始空头750U
RECOMMENDED_START_POSITION_C=-750.0         # C账户建议起始空头750U
# 净敞口: 1500-750-750=0 ✅

# 积分效率监控目标
TARGET_POINTS_PER_HOUR=100                  # 目标每小时100积分
TARGET_MAKER_ORDERS_PER_HOUR=50             # 目标每小时50个maker订单
TARGET_HOLDING_POINTS_PER_HOUR=30           # 目标每小时30持仓积分